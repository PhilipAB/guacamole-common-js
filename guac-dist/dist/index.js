var t=t||{};t.ArrayBufferReader=function(l){var e=this;l.onblob=function(n){for(var o=globalThis.atob(n),i=new ArrayBuffer(o.length),s=new Uint8Array(i),g=0;g<o.length;g++)s[g]=o.charCodeAt(g);e.ondata&&e.ondata(i)},l.onend=function(){e.onend&&e.onend()},this.ondata=null,this.onend=null};var t=t||{};t.ArrayBufferWriter=function(l){var e=this;l.onack=function(o){e.onack&&e.onack(o)};function n(o){for(var i="",s=0;s<o.byteLength;s++)i+=String.fromCharCode(o[s]);l.sendBlob(globalThis.btoa(i))}this.blobLength=t.ArrayBufferWriter.DEFAULT_BLOB_LENGTH,this.sendData=function(o){var i=new Uint8Array(o);if(i.length<=e.blobLength)n(i);else for(var s=0;s<i.length;s+=e.blobLength)n(i.subarray(s,s+e.blobLength))},this.sendEnd=function(){l.sendEnd()},this.onack=null};t.ArrayBufferWriter.DEFAULT_BLOB_LENGTH=6048;var t=t||{};t.AudioContextFactory={singleton:null,getAudioContext:function(){var e=globalThis.AudioContext||globalThis.webkitAudioContext;if(e)try{return t.AudioContextFactory.singleton||(t.AudioContextFactory.singleton=new e),t.AudioContextFactory.singleton}catch{}return null}};var t=t||{};t.AudioPlayer=function(){this.sync=function(){}};t.AudioPlayer.isSupportedType=function(e){return t.RawAudioPlayer.isSupportedType(e)};t.AudioPlayer.getSupportedTypes=function(){return t.RawAudioPlayer.getSupportedTypes()};t.AudioPlayer.getInstance=function(e,n){return t.RawAudioPlayer.isSupportedType(n)?new t.RawAudioPlayer(e,n):null};t.RawAudioPlayer=function(e,n){var o=t.RawAudioFormat.parse(n),i=t.AudioContextFactory.getAudioContext(),s=i.currentTime,g=new t.ArrayBufferReader(e),h=.02,d=.3,p=o.bytesPerSample===1?globalThis.Int8Array:globalThis.Int16Array,T=o.bytesPerSample===1?128:32768,I=[],x=function(S){if(S.length<=1)return S[0];var C=0;S.forEach(function(k){C+=k.length});var w=0,_=new p(C);return S.forEach(function(k){_.set(k,w),w+=k.length}),_},E=function(S){for(var C=Number.MAX_VALUE,w=S.length,_=Math.floor(S.length/o.channels),b=Math.floor(o.rate*h),k=Math.max(o.channels*b,o.channels*(_-b)),L=k;L<S.length;L+=o.channels){for(var P=0,R=0;R<o.channels;R++)P+=Math.abs(S[L+R]);P<=C&&(w=L+o.channels,C=P)}return w===S.length?[S]:[new p(S.buffer.slice(0,w*o.bytesPerSample)),new p(S.buffer.slice(w*o.bytesPerSample))]},f=function(S){I.push(new p(S))},u=function(){var S=x(I);return S?(I=E(S),S=I.shift(),S):null},v=function(S){var C=S.length/o.channels,w=i.currentTime;s<w&&(s=w);for(var _=i.createBuffer(o.channels,C,o.rate),b=0;b<o.channels;b++)for(var k=_.getChannelData(b),L=b,P=0;P<C;P++)k[P]=S[L]/T,L+=o.channels;return _};g.ondata=function(S){f(new p(S));var C=u();if(C){var w=i.currentTime;s<w&&(s=w);var _=i.createBufferSource();_.connect(i.destination),_.start||(_.start=_.noteOn),_.buffer=v(C),_.start(s),s+=C.length/o.channels/o.rate}},this.sync=function(){var S=i.currentTime;s=Math.min(s,S+d)}};t.RawAudioPlayer.prototype=new t.AudioPlayer;t.RawAudioPlayer.isSupportedType=function(e){return t.AudioContextFactory.getAudioContext()?t.RawAudioFormat.parse(e)!==null:!1};t.RawAudioPlayer.getSupportedTypes=function(){return t.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]};var t=t||{};t.AudioRecorder=function(){this.onclose=null,this.onerror=null};t.AudioRecorder.isSupportedType=function(e){return t.RawAudioRecorder.isSupportedType(e)};t.AudioRecorder.getSupportedTypes=function(){return t.RawAudioRecorder.getSupportedTypes()};t.AudioRecorder.getInstance=function(e,n){return t.RawAudioRecorder.isSupportedType(n)?new t.RawAudioRecorder(e,n):null};t.RawAudioRecorder=function(e,n){var o=this,i=2048,s=3,g=t.RawAudioFormat.parse(n),h=t.AudioContextFactory.getAudioContext();navigator.mediaDevices||(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia||(navigator.mediaDevices.getUserMedia=(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator));var d=new t.ArrayBufferWriter(e),p=g.bytesPerSample===1?globalThis.Int8Array:globalThis.Int16Array,T=g.bytesPerSample===1?128:32768,I=0,x=0,E=null,f=null,u=null,v=function(P){if(P===0)return 1;var R=Math.PI*P;return Math.sin(R)/R},y=function(P,R){return-R<P&&P<R?v(P)*v(P/R):0},S=function(P,R){for(var K=(P.length-1)*R,M=Math.floor(K)-s+1,N=Math.floor(K)+s,z=0,H=M;H<=N;H++)z+=(P[H]||0)*y(K-H,s);return z},C=function(P){var R=P.length;I+=R;var K=Math.round(I*g.rate/P.sampleRate),M=K-x;x+=M;for(var N=new p(M*g.channels),z=0;z<g.channels;z++)for(var H=P.getChannelData(z),B=z,O=0;O<M;O++)N[B]=S(H,O/(M-1))*T,B+=g.channels;return N},w=function(P){u=h.createScriptProcessor(i,g.channels,g.channels),u.connect(h.destination),u.onaudioprocess=function(K){d.sendData(C(K.inputBuffer).buffer)},f=h.createMediaStreamSource(P),f.connect(u),h.state==="suspended"&&h.resume(),E=P},_=function(){d.sendEnd(),o.onerror&&o.onerror()},b=function(){var P=navigator.mediaDevices.getUserMedia({audio:!0},w,_);P&&P.then&&P.then(w,_)},k=function(){if(f&&f.disconnect(),u&&u.disconnect(),E)for(var P=E.getTracks(),R=0;R<P.length;R++)P[R].stop();u=null,f=null,E=null,d.sendEnd()};d.onack=function(P){P.code===t.Status.Code.SUCCESS&&!E?b():(k(),d.onack=null,P.code===t.Status.Code.RESOURCE_CLOSED?o.onclose&&o.onclose():o.onerror&&o.onerror())}};t.RawAudioRecorder.prototype=new t.AudioRecorder;t.RawAudioRecorder.isSupportedType=function(e){return t.AudioContextFactory.getAudioContext()?t.RawAudioFormat.parse(e)!==null:!1};t.RawAudioRecorder.getSupportedTypes=function(){return t.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]};var t=t||{};t.BlobReader=function(l,e){var n=this,o=0,i;globalThis.BlobBuilder?i=new BlobBuilder:globalThis.WebKitBlobBuilder?i=new WebKitBlobBuilder:globalThis.MozBlobBuilder?i=new MozBlobBuilder:i=new function(){var s=[];this.append=function(g){s.push(new Blob([g],{type:e}))},this.getBlob=function(){return new Blob(s,{type:e})}},l.onblob=function(s){for(var g=globalThis.atob(s),h=new ArrayBuffer(g.length),d=new Uint8Array(h),p=0;p<g.length;p++)d[p]=g.charCodeAt(p);i.append(h),o+=h.byteLength,n.onprogress&&n.onprogress(h.byteLength),l.sendAck("OK",0)},l.onend=function(){n.onend&&n.onend()},this.getLength=function(){return o},this.getBlob=function(){return i.getBlob()},this.onprogress=null,this.onend=null};var t=t||{};t.BlobWriter=function(e){var n=this,o=new t.ArrayBufferWriter(e);o.onack=function(s){n.onack&&n.onack(s)};var i=function(g,h,d){var p=(g.slice||g.webkitSlice||g.mozSlice).bind(g),T=d-h;if(T!==d){var I=p(h,T);if(I.size===T)return I}return p(h,d)};this.sendBlob=function(g){var h=0,d=new FileReader,p=function(){if(h>=g.size){n.oncomplete&&n.oncomplete(g);return}var I=i(g,h,h+o.blobLength);h+=o.blobLength,d.readAsArrayBuffer(I)};d.onload=function(){o.sendData(d.result),o.onack=function(x){n.onack&&n.onack(x),!x.isError()&&(n.onprogress&&n.onprogress(g,h-o.blobLength),p())}},d.onerror=function(){n.onerror&&n.onerror(g,h,d.error)},p()},this.sendEnd=function(){o.sendEnd()},this.onack=null,this.onerror=null,this.onprogress=null,this.oncomplete=null};var t=t||{};t.Client=function(l){var e=this,n=0,o=1,i=2,s=3,g=4,h=5,d=n,p=0,T=5e3,I=null,x=0,E={0:"butt",1:"round",2:"square"},f={0:"bevel",1:"miter",2:"round"},u=new t.Display,v={},y={},S={},C=[],w=[],_=[],b=new t.IntegerPool,k=[];function L(r){r!=d&&(d=r,e.onstatechange&&e.onstatechange(d))}function P(){return d==s||d==i}this.exportState=function(a){var c={currentState:d,currentTimestamp:p,layers:{}},F={};for(var m in v)F[m]=v[m];u.flush(function(){for(var D in F){var U=parseInt(D),G=F[D],Y=G.toCanvas(),X={width:G.width,height:G.height};G.width&&G.height&&(X.url=Y.toDataURL("image/png")),U>0&&(X.x=G.x,X.y=G.y,X.z=G.z,X.alpha=G.alpha,X.matrix=G.matrix,X.parent=K(G.parent)),c.layers[D]=X}a(c)})},this.importState=function(a,c){var F,m;d=a.currentState,p=a.currentTimestamp,u.cancel();for(F in v)m=parseInt(F),m>0&&v[F].dispose();v={};for(F in a.layers){m=parseInt(F);var A=a.layers[F],D=R(m);if(u.resize(D,A.width,A.height),A.url&&(u.setChannelMask(D,t.Layer.SRC),u.draw(D,0,0,A.url)),m>0&&A.parent>=0){var U=R(A.parent);u.move(D,U,A.x,A.y,A.z),u.shade(D,A.alpha);var G=A.matrix;u.distort(D,G[0],G[1],G[2],G[3],G[4],G[5])}}u.flush(c)},this.getDisplay=function(){return u},this.sendSize=function(r,a){P()&&l.sendMessage("size",r,a)},this.sendKeyEvent=function(r,a){P()&&l.sendMessage("key",a,r)},this.sendMouseState=function(a,c){if(P()){var F=a.x,m=a.y;c&&(F/=u.getScale(),m/=u.getScale()),u.moveCursor(Math.floor(F),Math.floor(m));var A=0;a.left&&(A|=1),a.middle&&(A|=2),a.right&&(A|=4),a.up&&(A|=8),a.down&&(A|=16),l.sendMessage("mouse",Math.floor(F),Math.floor(m),A)}},this.sendTouchState=function(a,c){if(P()){var F=a.x,m=a.y;c&&(F/=u.getScale(),m/=u.getScale()),l.sendMessage("touch",a.id,Math.floor(F),Math.floor(m),Math.floor(a.radiusX),Math.floor(a.radiusY),a.angle,a.force)}},this.createOutputStream=function(){var a=b.next(),c=k[a]=new t.OutputStream(e,a);return c},this.createAudioStream=function(r){var a=e.createOutputStream();return l.sendMessage("audio",a.index,r),a},this.createFileStream=function(r,a){var c=e.createOutputStream();return l.sendMessage("file",c.index,r,a),c},this.createPipeStream=function(r,a){var c=e.createOutputStream();return l.sendMessage("pipe",c.index,r,a),c},this.createClipboardStream=function(r){var a=e.createOutputStream();return l.sendMessage("clipboard",a.index,r),a},this.createArgumentValueStream=function(a,c){var F=e.createOutputStream();return l.sendMessage("argv",F.index,a,c),F},this.createObjectOutputStream=function(a,c,F){var m=e.createOutputStream();return l.sendMessage("put",a,m.index,c,F),m},this.requestObjectInputStream=function(a,c){P()&&l.sendMessage("get",a,c)},this.sendAck=function(r,a,c){P()&&l.sendMessage("ack",r,a,c)},this.sendBlob=function(r,a){P()&&l.sendMessage("blob",r,a)},this.endStream=function(r){P()&&(l.sendMessage("end",r),k[r]&&(b.free(r),delete k[r]))},this.onstatechange=null,this.onname=null,this.onerror=null,this.onmsg=null,this.onjoin=null,this.onleave=null,this.onaudio=null,this.onvideo=null,this.onmultitouch=null,this.onargv=null,this.onclipboard=null,this.onfile=null,this.onfilesystem=null,this.onpipe=null,this.onrequired=null,this.onsync=null;var R=function(a){var c=v[a];return c||(a===0?c=u.getDefaultLayer():a>0?c=u.createLayer():c=u.createBuffer(),v[a]=c),c},K=function(a){if(!a)return null;for(var c in v)if(a===v[c])return parseInt(c);return null};function M(r){var a=C[r];return a==null&&(a=C[r]=new t.Parser,a.oninstruction=l.oninstruction),a}var N={"miter-limit":function(r,a){u.setMiterLimit(r,parseFloat(a))},"multi-touch":function(a,c){e.onmultitouch&&a instanceof t.Display.VisibleLayer&&e.onmultitouch(a,parseInt(c))}},z={ack:function(r){var a=parseInt(r[0]),c=r[1],F=parseInt(r[2]),m=k[a];m&&(m.onack&&m.onack(new t.Status(F,c)),F>=256&&k[a]===m&&(b.free(a),delete k[a]))},arc:function(r){var a=R(parseInt(r[0])),c=parseInt(r[1]),F=parseInt(r[2]),m=parseInt(r[3]),A=parseFloat(r[4]),D=parseFloat(r[5]),U=parseInt(r[6]);u.arc(a,c,F,m,A,D,U!=0)},argv:function(r){var a=parseInt(r[0]),c=r[1],F=r[2];if(e.onargv){var m=w[a]=new t.InputStream(e,a);e.onargv(m,c,F)}else e.sendAck(a,"Receiving argument values unsupported",256)},audio:function(r){var a=parseInt(r[0]),c=r[1],F=w[a]=new t.InputStream(e,a),m=null;e.onaudio&&(m=e.onaudio(F,c)),m||(m=t.AudioPlayer.getInstance(F,c)),m?(y[a]=m,e.sendAck(a,"OK",0)):e.sendAck(a,"BAD TYPE",783)},blob:function(r){var a=parseInt(r[0]),c=r[1],F=w[a];F&&F.onblob&&F.onblob(c)},body:function(a){var c=parseInt(a[0]),F=_[c],m=parseInt(a[1]),A=a[2],D=a[3];if(F&&F.onbody){var U=w[m]=new t.InputStream(e,m);F.onbody(U,A,D)}else e.sendAck(m,"Receipt of body unsupported",256)},cfill:function(r){var a=parseInt(r[0]),c=R(parseInt(r[1])),F=parseInt(r[2]),m=parseInt(r[3]),A=parseInt(r[4]),D=parseInt(r[5]);u.setChannelMask(c,a),u.fillColor(c,F,m,A,D)},clip:function(r){var a=R(parseInt(r[0]));u.clip(a)},clipboard:function(r){var a=parseInt(r[0]),c=r[1];if(e.onclipboard){var F=w[a]=new t.InputStream(e,a);e.onclipboard(F,c)}else e.sendAck(a,"Clipboard unsupported",256)},close:function(r){var a=R(parseInt(r[0]));u.close(a)},copy:function(r){var a=R(parseInt(r[0])),c=parseInt(r[1]),F=parseInt(r[2]),m=parseInt(r[3]),A=parseInt(r[4]),D=parseInt(r[5]),U=R(parseInt(r[6])),G=parseInt(r[7]),Y=parseInt(r[8]);u.setChannelMask(U,D),u.copy(a,c,F,m,A,U,G,Y)},cstroke:function(r){var a=parseInt(r[0]),c=R(parseInt(r[1])),F=E[parseInt(r[2])],m=f[parseInt(r[3])],A=parseInt(r[4]),D=parseInt(r[5]),U=parseInt(r[6]),G=parseInt(r[7]),Y=parseInt(r[8]);u.setChannelMask(c,a),u.strokeColor(c,F,m,A,D,U,G,Y)},cursor:function(r){var a=parseInt(r[0]),c=parseInt(r[1]),F=R(parseInt(r[2])),m=parseInt(r[3]),A=parseInt(r[4]),D=parseInt(r[5]),U=parseInt(r[6]);u.setCursor(a,c,F,m,A,D,U)},curve:function(r){var a=R(parseInt(r[0])),c=parseInt(r[1]),F=parseInt(r[2]),m=parseInt(r[3]),A=parseInt(r[4]),D=parseInt(r[5]),U=parseInt(r[6]);u.curveTo(a,c,F,m,A,D,U)},disconnect:function(a){e.disconnect()},dispose:function(r){var a=parseInt(r[0]);if(a>0){var c=R(a);u.dispose(c),delete v[a]}else a<0&&delete v[a]},distort:function(r){var a=parseInt(r[0]),c=parseFloat(r[1]),F=parseFloat(r[2]),m=parseFloat(r[3]),A=parseFloat(r[4]),D=parseFloat(r[5]),U=parseFloat(r[6]);if(a>=0){var G=R(a);u.distort(G,c,F,m,A,D,U)}},error:function(r){var a=r[0],c=parseInt(r[1]);e.onerror&&e.onerror(new t.Status(c,a)),e.disconnect()},end:function(r){var a=parseInt(r[0]),c=w[a];c&&(c.onend&&c.onend(),delete w[a])},file:function(r){var a=parseInt(r[0]),c=r[1],F=r[2];if(e.onfile){var m=w[a]=new t.InputStream(e,a);e.onfile(m,c,F)}else e.sendAck(a,"File transfer unsupported",256)},filesystem:function(a){var c=parseInt(a[0]),F=a[1];if(e.onfilesystem){var m=_[c]=new t.Object(e,c);e.onfilesystem(m,F)}},identity:function(r){var a=R(parseInt(r[0]));u.setTransform(a,1,0,0,1,0,0)},img:function(r){var a=parseInt(r[0]),c=parseInt(r[1]),F=R(parseInt(r[2])),m=r[3],A=parseInt(r[4]),D=parseInt(r[5]),U=w[a]=new t.InputStream(e,a);u.setChannelMask(F,c),u.drawStream(F,A,D,U,m)},jpeg:function(r){var a=parseInt(r[0]),c=R(parseInt(r[1])),F=parseInt(r[2]),m=parseInt(r[3]),A=r[4];u.setChannelMask(c,a),u.draw(c,F,m,"data:image/jpeg;base64,"+A)},lfill:function(r){var a=parseInt(r[0]),c=R(parseInt(r[1])),F=R(parseInt(r[2]));u.setChannelMask(c,a),u.fillLayer(c,F)},line:function(r){var a=R(parseInt(r[0])),c=parseInt(r[1]),F=parseInt(r[2]);u.lineTo(a,c,F)},lstroke:function(r){var a=parseInt(r[0]),c=R(parseInt(r[1])),F=R(parseInt(r[2]));u.setChannelMask(c,a),u.strokeLayer(c,F)},mouse:function(a){var c=parseInt(a[0]),F=parseInt(a[1]);u.showCursor(!0),u.moveCursor(c,F)},move:function(r){var a=parseInt(r[0]),c=parseInt(r[1]),F=parseInt(r[2]),m=parseInt(r[3]),A=parseInt(r[4]);if(a>0&&c>=0){var D=R(a),U=R(c);u.move(D,U,F,m,A)}},msg:function(r){var a,c,F=!0,m=parseInt(r[0]);if(e.onmsg&&(F=e.onmsg(m,r.slice(1)),F===void 0&&(F=!0)),F)switch(m){case t.Client.Message.USER_JOINED:a=r[1],c=r[2],e.onjoin&&e.onjoin(a,c);break;case t.Client.Message.USER_LEFT:a=r[1],c=r[2],e.onleave&&e.onleave(a,c);break}},name:function(r){e.onname&&e.onname(r[0])},nest:function(r){var a=M(parseInt(r[0]));a.receive(r[1])},pipe:function(r){var a=parseInt(r[0]),c=r[1],F=r[2];if(e.onpipe){var m=w[a]=new t.InputStream(e,a);e.onpipe(m,c,F)}else e.sendAck(a,"Named pipes unsupported",256)},png:function(r){var a=parseInt(r[0]),c=R(parseInt(r[1])),F=parseInt(r[2]),m=parseInt(r[3]),A=r[4];u.setChannelMask(c,a),u.draw(c,F,m,"data:image/png;base64,"+A)},pop:function(r){var a=R(parseInt(r[0]));u.pop(a)},push:function(r){var a=R(parseInt(r[0]));u.push(a)},rect:function(r){var a=R(parseInt(r[0])),c=parseInt(r[1]),F=parseInt(r[2]),m=parseInt(r[3]),A=parseInt(r[4]);u.rect(a,c,F,m,A)},required:function(a){e.onrequired&&e.onrequired(a)},reset:function(r){var a=R(parseInt(r[0]));u.reset(a)},set:function(r){var a=R(parseInt(r[0])),c=r[1],F=r[2],m=N[c];m&&m(a,F)},shade:function(r){var a=parseInt(r[0]),c=parseInt(r[1]);if(a>=0){var F=R(a);u.shade(F,c)}},size:function(r){var a=parseInt(r[0]),c=R(a),F=parseInt(r[1]),m=parseInt(r[2]);u.resize(c,F,m)},start:function(r){var a=R(parseInt(r[0])),c=parseInt(r[1]),F=parseInt(r[2]);u.moveTo(a,c,F)},sync:function(r){var a=parseInt(r[0]);u.flush(function(){for(var F in y){var m=y[F];m&&m.sync()}a!==p&&(l.sendMessage("sync",a),p=a)}),d===i&&L(s),e.onsync&&e.onsync(a)},transfer:function(r){var a=R(parseInt(r[0])),c=parseInt(r[1]),F=parseInt(r[2]),m=parseInt(r[3]),A=parseInt(r[4]),D=parseInt(r[5]),U=R(parseInt(r[6])),G=parseInt(r[7]),Y=parseInt(r[8]);D===3?u.put(a,c,F,m,A,U,G,Y):D!==5&&u.transfer(a,c,F,m,A,U,G,Y,t.Client.DefaultTransferFunction[D])},transform:function(r){var a=R(parseInt(r[0])),c=parseFloat(r[1]),F=parseFloat(r[2]),m=parseFloat(r[3]),A=parseFloat(r[4]),D=parseFloat(r[5]),U=parseFloat(r[6]);u.transform(a,c,F,m,A,D,U)},undefine:function(a){var c=parseInt(a[0]),F=_[c];F&&F.onundefine&&F.onundefine()},video:function(r){var a=parseInt(r[0]),c=R(parseInt(r[1])),F=r[2],m=w[a]=new t.InputStream(e,a),A=null;e.onvideo&&(A=e.onvideo(m,c,F)),A||(A=t.VideoPlayer.getInstance(m,c,F)),A?(S[a]=A,e.sendAck(a,"OK",0)):e.sendAck(a,"BAD TYPE",783)}},H=function(){l.sendMessage("nop"),x=new Date().getTime()},B=function(){globalThis.clearTimeout(I);var a=new Date().getTime(),c=Math.max(x+T-a,0);c>0?I=globalThis.setTimeout(H,c):H()},O=function(){globalThis.clearTimeout(I)};l.oninstruction=function(r,a){var c=z[r];c&&c(a),B()},this.disconnect=function(){d!=h&&d!=g&&(L(g),O(),l.sendMessage("disconnect"),l.disconnect(),L(h))},this.connect=function(r){L(o);try{l.connect(r)}catch(a){throw L(n),a}B(),L(i)}};t.Client.DefaultTransferFunction={0:function(l,e){e.red=e.green=e.blue=0},15:function(l,e){e.red=e.green=e.blue=255},3:function(l,e){e.red=l.red,e.green=l.green,e.blue=l.blue,e.alpha=l.alpha},5:function(l,e){},12:function(l,e){e.red=255&~l.red,e.green=255&~l.green,e.blue=255&~l.blue,e.alpha=l.alpha},10:function(l,e){e.red=255&~e.red,e.green=255&~e.green,e.blue=255&~e.blue},1:function(l,e){e.red=l.red&e.red,e.green=l.green&e.green,e.blue=l.blue&e.blue},14:function(l,e){e.red=255&~(l.red&e.red),e.green=255&~(l.green&e.green),e.blue=255&~(l.blue&e.blue)},7:function(l,e){e.red=l.red|e.red,e.green=l.green|e.green,e.blue=l.blue|e.blue},8:function(l,e){e.red=255&~(l.red|e.red),e.green=255&~(l.green|e.green),e.blue=255&~(l.blue|e.blue)},6:function(l,e){e.red=l.red^e.red,e.green=l.green^e.green,e.blue=l.blue^e.blue},9:function(l,e){e.red=255&~(l.red^e.red),e.green=255&~(l.green^e.green),e.blue=255&~(l.blue^e.blue)},4:function(l,e){e.red=255&(~l.red&e.red),e.green=255&(~l.green&e.green),e.blue=255&(~l.blue&e.blue)},13:function(l,e){e.red=255&(~l.red|e.red),e.green=255&(~l.green|e.green),e.blue=255&(~l.blue|e.blue)},2:function(l,e){e.red=255&(l.red&~e.red),e.green=255&(l.green&~e.green),e.blue=255&(l.blue&~e.blue)},11:function(l,e){e.red=255&(l.red|~e.red),e.green=255&(l.green|~e.green),e.blue=255&(l.blue|~e.blue)}};t.Client.Message={USER_JOINED:1,USER_LEFT:2};var t=t||{};t.DataURIReader=function(l,e){var n=this,o="data:"+e+";base64,";l.onblob=function(s){o+=s},l.onend=function(){n.onend&&n.onend()},this.getURI=function(){return o},this.onend=null};var t=t||{};t.Display=function(){var l=this,e=0,n=0,o=1,i=document.createElement("div");i.style.position="relative",i.style.width=e+"px",i.style.height=n+"px",i.style.transformOrigin=i.style.webkitTransformOrigin=i.style.MozTransformOrigin=i.style.OTransformOrigin=i.style.msTransformOrigin="0 0";var s=new t.Display.VisibleLayer(e,n),g=new t.Display.VisibleLayer(0,0);g.setChannelMask(t.Layer.SRC),i.appendChild(s.getElement()),i.appendChild(g.getElement());var h=document.createElement("div");h.style.position="relative",h.style.width=e*o+"px",h.style.height=n*o+"px",h.appendChild(i),this.cursorHotspotX=0,this.cursorHotspotY=0,this.cursorX=0,this.cursorY=0,this.onresize=null,this.oncursor=null;var d=[],p=[];function T(){for(var f=0;f<p.length;){var u=p[f];if(!u.isReady())break;u.flush(),f++}p.splice(0,f)}function I(f,u){this.cancel=function(){f=null,u.forEach(function(S){S.cancel()}),u=[]},this.isReady=function(){for(var v=0;v<u.length;v++)if(u[v].blocked)return!1;return!0},this.flush=function(){for(var v=0;v<u.length;v++)u[v].execute();f&&f()}}function x(f,u){var v=this;this.blocked=u,this.cancel=function(){v.blocked=!1,f=null},this.unblock=function(){v.blocked&&(v.blocked=!1,T())},this.execute=function(){f&&f()}}function E(f,u){var v=new x(f,u);return d.push(v),v}this.getElement=function(){return h},this.getWidth=function(){return e},this.getHeight=function(){return n},this.getDefaultLayer=function(){return s},this.getCursorLayer=function(){return g},this.createLayer=function(){var f=new t.Display.VisibleLayer(e,n);return f.move(s,0,0,0),f},this.createBuffer=function(){var f=new t.Layer(0,0);return f.autosize=1,f},this.flush=function(f){p.push(new I(f,d)),d=[],T()},this.cancel=function(){p.forEach(function(v){v.cancel()}),p=[],d.forEach(function(v){v.cancel()}),d=[]},this.setCursor=function(f,u,v,y,S,C,w){E(function(){l.cursorHotspotX=f,l.cursorHotspotY=u,g.resize(C,w),g.copy(v,y,S,C,w,0,0),l.moveCursor(l.cursorX,l.cursorY),l.oncursor&&l.oncursor(g.toCanvas(),f,u)})},this.showCursor=function(f){var u=g.getElement(),v=u.parentNode;f===!1?v&&v.removeChild(u):v!==i&&i.appendChild(u)},this.moveCursor=function(f,u){g.translate(f-l.cursorHotspotX,u-l.cursorHotspotY),l.cursorX=f,l.cursorY=u},this.resize=function(f,u,v){E(function(){f.resize(u,v),f===s&&(e=u,n=v,i.style.width=e+"px",i.style.height=n+"px",h.style.width=e*o+"px",h.style.height=n*o+"px",l.onresize&&l.onresize(u,v))})},this.drawImage=function(f,u,v,y){E(function(){f.drawImage(u,v,y)})},this.drawBlob=function(f,u,v,y){var S;if(globalThis.createImageBitmap){var C;S=E(function(){f.drawImage(u,v,C)},!0),globalThis.createImageBitmap(y).then(function(k){C=k,S.unblock()})}else{var w=URL.createObjectURL(y);S=E(function(){_.width&&_.height&&f.drawImage(u,v,_),URL.revokeObjectURL(w)},!0);var _=new Image;_.onload=S.unblock,_.onerror=S.unblock,_.src=w}},this.drawStream=function(u,v,y,S,C){if(globalThis.createImageBitmap){var w=new t.BlobReader(S,C);w.onend=function(){l.drawBlob(u,v,y,w.getBlob())}}else{var w=new t.DataURIReader(S,C);w.onend=function(){l.draw(u,v,y,w.getURI())}}},this.draw=function(f,u,v,y){var S=E(function(){C.width&&C.height&&f.drawImage(u,v,C)},!0),C=new Image;C.onload=S.unblock,C.onerror=S.unblock,C.src=y},this.play=function(f,u,v,y){var S=document.createElement("video");S.type=u,S.src=y,S.addEventListener("play",function(){function C(){f.drawImage(0,0,S),S.ended||globalThis.setTimeout(C,20)}C()},!1),E(S.play)},this.transfer=function(f,u,v,y,S,C,w,_,b){E(function(){C.transfer(f,u,v,y,S,w,_,b)})},this.put=function(f,u,v,y,S,C,w,_){E(function(){C.put(f,u,v,y,S,w,_)})},this.copy=function(f,u,v,y,S,C,w,_){E(function(){C.copy(f,u,v,y,S,w,_)})},this.moveTo=function(f,u,v){E(function(){f.moveTo(u,v)})},this.lineTo=function(f,u,v){E(function(){f.lineTo(u,v)})},this.arc=function(f,u,v,y,S,C,w){E(function(){f.arc(u,v,y,S,C,w)})},this.curveTo=function(f,u,v,y,S,C,w){E(function(){f.curveTo(u,v,y,S,C,w)})},this.close=function(f){E(function(){f.close()})},this.rect=function(f,u,v,y,S){E(function(){f.rect(u,v,y,S)})},this.clip=function(f){E(function(){f.clip()})},this.strokeColor=function(f,u,v,y,S,C,w,_){E(function(){f.strokeColor(u,v,y,S,C,w,_)})},this.fillColor=function(f,u,v,y,S){E(function(){f.fillColor(u,v,y,S)})},this.strokeLayer=function(f,u,v,y,S){E(function(){f.strokeLayer(u,v,y,S)})},this.fillLayer=function(f,u){E(function(){f.fillLayer(u)})},this.push=function(f){E(function(){f.push()})},this.pop=function(f){E(function(){f.pop()})},this.reset=function(f){E(function(){f.reset()})},this.setTransform=function(f,u,v,y,S,C,w){E(function(){f.setTransform(u,v,y,S,C,w)})},this.transform=function(f,u,v,y,S,C,w){E(function(){f.transform(u,v,y,S,C,w)})},this.setChannelMask=function(f,u){E(function(){f.setChannelMask(u)})},this.setMiterLimit=function(f,u){E(function(){f.setMiterLimit(u)})},this.dispose=function(u){E(function(){u.dispose()})},this.distort=function(u,v,y,S,C,w,_){E(function(){u.distort(v,y,S,C,w,_)})},this.move=function(u,v,y,S,C){E(function(){u.move(v,y,S,C)})},this.shade=function(u,v){E(function(){u.shade(v)})},this.scale=function(f){i.style.transform=i.style.WebkitTransform=i.style.MozTransform=i.style.OTransform=i.style.msTransform="scale("+f+","+f+")",o=f,h.style.width=e*o+"px",h.style.height=n*o+"px"},this.getScale=function(){return o},this.flatten=function(){var f=document.createElement("canvas");f.width=s.width,f.height=s.height;var u=f.getContext("2d");function v(S){var C=[];for(var w in S.children)C.push(S.children[w]);return C.sort(function(b,k){var L=b.z-k.z;if(L!==0)return L;var P=b.getElement(),R=k.getElement(),K=R.compareDocumentPosition(P);return K&Node.DOCUMENT_POSITION_PRECEDING?-1:K&Node.DOCUMENT_POSITION_FOLLOWING?1:0}),C}function y(S,C,w){if(S.width>0&&S.height>0){var _=u.globalAlpha;u.globalAlpha*=S.alpha/255,u.drawImage(S.getCanvas(),C,w);for(var b=v(S),k=0;k<b.length;k++){var L=b[k];y(L,C+L.x,w+L.y)}u.globalAlpha=_}}return y(s,0,0),f}};t.Display.VisibleLayer=function(l,e){t.Layer.apply(this,[l,e]);var n=this;this.__unique_id=t.Display.VisibleLayer.__next_id++,this.alpha=255,this.x=0,this.y=0,this.z=0,this.matrix=[1,0,0,1,0,0],this.parent=null,this.children={};var o=n.getCanvas();o.style.position="absolute",o.style.left="0px",o.style.top="0px";var i=document.createElement("div");i.appendChild(o),i.style.width=l+"px",i.style.height=e+"px",i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style.overflow="hidden";var s=this.resize;this.resize=function(d,p){i.style.width=d+"px",i.style.height=p+"px",s(d,p)},this.getElement=function(){return i};var g="translate(0px, 0px)",h="matrix(1, 0, 0, 1, 0, 0)";this.translate=function(d,p){n.x=d,n.y=p,g="translate("+d+"px,"+p+"px)",i.style.transform=i.style.WebkitTransform=i.style.MozTransform=i.style.OTransform=i.style.msTransform=g+" "+h},this.move=function(d,p,T,I){if(n.parent!==d){n.parent&&delete n.parent.children[n.__unique_id],n.parent=d,d.children[n.__unique_id]=n;var x=d.getElement();x.appendChild(i)}n.translate(p,T),n.z=I,i.style.zIndex=I},this.shade=function(d){n.alpha=d,i.style.opacity=d/255},this.dispose=function(){n.parent&&(delete n.parent.children[n.__unique_id],n.parent=null),i.parentNode&&i.parentNode.removeChild(i)},this.distort=function(d,p,T,I,x,E){n.matrix=[d,p,T,I,x,E],h="matrix("+d+","+p+","+T+","+I+","+x+","+E+")",i.style.transform=i.style.WebkitTransform=i.style.MozTransform=i.style.OTransform=i.style.msTransform=g+" "+h}};t.Display.VisibleLayer.__next_id=0;var t=t||{};t.Event=function(e){this.type=e,this.timestamp=new Date().getTime(),this.getAge=function(){return new Date().getTime()-this.timestamp},this.invokeLegacyHandler=function(o){}};t.Event.DOMEvent=function(e,n){t.Event.call(this,e),n=n||[],Array.isArray(n)||(n=[n]),this.preventDefault=function(){n.forEach(function(s){s.preventDefault&&s.preventDefault(),s.returnValue=!1})},this.stopPropagation=function(){n.forEach(function(s){s.stopPropagation()})}};t.Event.DOMEvent.cancelEvent=function(e){e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1};t.Event.Target=function(){var e={};this.on=function(o,i){var s=e[o];s||(e[o]=s=[]),s.push(i)},this.onEach=function(o,i){o.forEach(function(g){this.on(g,i)},this)},this.dispatch=function(o){o.invokeLegacyHandler(this);var i=e[o.type];if(i)for(var s=0;s<i.length;s++)i[s](o,this)},this.off=function(o,i){var s=e[o];if(!s)return!1;for(var g=0;g<s.length;g++)if(s[g]===i)return s.splice(g,1),!0;return!1},this.offEach=function(o,i){var s=!1;return o.forEach(function(h){s|=this.off(h,i)},this),s}};var t=t||{};t.InputSink=function(){var e=this,n=document.createElement("textarea");n.style.position="fixed",n.style.outline="none",n.style.border="none",n.style.margin="0",n.style.padding="0",n.style.height="0",n.style.width="0",n.style.left="0",n.style.bottom="0",n.style.resize="none",n.style.background="transparent",n.style.color="transparent",n.addEventListener("keypress",function(i){n.value=""},!1),n.addEventListener("compositionend",function(i){i.data&&(n.value="")},!1),n.addEventListener("input",function(i){i.data&&!i.isComposing&&(n.value="")},!1),n.addEventListener("focus",function(){globalThis.setTimeout(function(){n.click(),n.select()},0)},!0),this.focus=function(){globalThis.setTimeout(function(){n.focus()},0)},this.getElement=function(){return n},document.addEventListener("keydown",function(i){var s=document.activeElement;if(s&&s!==document.body){var g=s.getBoundingClientRect();if(g.left+g.width>0&&g.top+g.height>0)return}e.focus()},!0)};var t=t||{};t.InputStream=function(l,e){var n=this;this.index=e,this.onblob=null,this.onend=null,this.sendAck=function(o,i){l.sendAck(n.index,o,i)}};var t=t||{};t.IntegerPool=function(){var l=this,e=[];this.next_int=0,this.next=function(){return e.length>0?e.shift():l.next_int++},this.free=function(n){e.push(n)}};var t=t||{};t.JSONReader=function(e){var n=this,o=new t.StringReader(e),i="";this.getLength=function(){return i.length},this.getJSON=function(){return JSON.parse(i)},o.ontext=function(g){i+=g,n.onprogress&&n.onprogress(g.length)},o.onend=function(){n.onend&&n.onend()},this.onprogress=null,this.onend=null};var t=t||{};t.Keyboard=function(e){var n=this,o=t.Keyboard._nextID++,i="_GUAC_KEYBOARD_HANDLED_BY_"+o;this.onkeydown=null,this.onkeyup=null;var s={keyupUnreliable:!1,altIsTypableOnly:!1,capsLockKeyupUnreliable:!1};navigator&&navigator.platform&&(navigator.platform.match(/ipad|iphone|ipod/i)?s.keyupUnreliable=!0:navigator.platform.match(/^mac/i)&&(s.altIsTypableOnly=!0,s.capsLockKeyupUnreliable=!0));var g=function(a){var c=this;this.keyCode=a?a.which||a.keyCode:0,this.keyIdentifier=a&&a.keyIdentifier,this.key=a&&a.key,this.location=a?B(a):0,this.modifiers=a?t.Keyboard.ModifierState.fromKeyboardEvent(a):new t.Keyboard.ModifierState,this.timestamp=new Date().getTime(),this.defaultPrevented=!1,this.keysym=null,this.reliable=!1,this.getAge=function(){return new Date().getTime()-c.timestamp}},h=function(a){g.call(this,a),this.keysym=_(this.key,this.location)||L(this.keyCode,this.location),this.keyupReliable=!s.keyupUnreliable,this.keysym&&!w(this.keysym)&&(this.reliable=!0),!this.keysym&&P(this.keyCode,this.keyIdentifier)&&(this.keysym=_(this.keyIdentifier,this.location,this.modifiers.shift)),this.modifiers.meta&&this.keysym!==65511&&this.keysym!==65512?this.keyupReliable=!1:this.keysym===65509&&s.capsLockKeyupUnreliable&&(this.keyupReliable=!1);var c=!this.modifiers.ctrl&&!s.altIsTypableOnly,F=!this.modifiers.alt;(F&&this.modifiers.ctrl||c&&this.modifiers.alt||this.modifiers.meta||this.modifiers.hyper)&&(this.reliable=!0),v[this.keyCode]=this.keysym};h.prototype=new g;var d=function(a){g.call(this,a),this.keysym=k(this.keyCode),this.reliable=!0};d.prototype=new g;var p=function(a){g.call(this,a),this.keysym=L(this.keyCode,this.location)||_(this.key,this.location),n.pressed[this.keysym]||(this.keysym=v[this.keyCode]||this.keysym),this.reliable=!0};p.prototype=new g;var T=[],I={8:[65288],9:[65289],12:[65291,65291,65291,65461],13:[65293],16:[65505,65505,65506],17:[65507,65507,65508],18:[65513,65513,65027],19:[65299],20:[65509],27:[65307],32:[32],33:[65365,65365,65365,65465],34:[65366,65366,65366,65459],35:[65367,65367,65367,65457],36:[65360,65360,65360,65463],37:[65361,65361,65361,65460],38:[65362,65362,65362,65464],39:[65363,65363,65363,65462],40:[65364,65364,65364,65458],45:[65379,65379,65379,65456],46:[65535,65535,65535,65454],91:[65511],92:[65512],93:[65383],96:[65456],97:[65457],98:[65458],99:[65459],100:[65460],101:[65461],102:[65462],103:[65463],104:[65464],105:[65465],106:[65450],107:[65451],109:[65453],110:[65454],111:[65455],112:[65470],113:[65471],114:[65472],115:[65473],116:[65474],117:[65475],118:[65476],119:[65477],120:[65478],121:[65479],122:[65480],123:[65481],144:[65407],145:[65300],225:[65027]},x={Again:[65382],AllCandidates:[65341],Alphanumeric:[65328],Alt:[65513,65513,65027],Attn:[64782],AltGraph:[65027],ArrowDown:[65364],ArrowLeft:[65361],ArrowRight:[65363],ArrowUp:[65362],Backspace:[65288],CapsLock:[65509],Cancel:[65385],Clear:[65291],Convert:[65313],Copy:[64789],Crsel:[64796],CrSel:[64796],CodeInput:[65335],Compose:[65312],Control:[65507,65507,65508],ContextMenu:[65383],Delete:[65535],Down:[65364],End:[65367],Enter:[65293],EraseEof:[64774],Escape:[65307],Execute:[65378],Exsel:[64797],ExSel:[64797],F1:[65470],F2:[65471],F3:[65472],F4:[65473],F5:[65474],F6:[65475],F7:[65476],F8:[65477],F9:[65478],F10:[65479],F11:[65480],F12:[65481],F13:[65482],F14:[65483],F15:[65484],F16:[65485],F17:[65486],F18:[65487],F19:[65488],F20:[65489],F21:[65490],F22:[65491],F23:[65492],F24:[65493],Find:[65384],GroupFirst:[65036],GroupLast:[65038],GroupNext:[65032],GroupPrevious:[65034],FullWidth:null,HalfWidth:null,HangulMode:[65329],Hankaku:[65321],HanjaMode:[65332],Help:[65386],Hiragana:[65317],HiraganaKatakana:[65319],Home:[65360],Hyper:[65517,65517,65518],Insert:[65379],JapaneseHiragana:[65317],JapaneseKatakana:[65318],JapaneseRomaji:[65316],JunjaMode:[65336],KanaMode:[65325],KanjiMode:[65313],Katakana:[65318],Left:[65361],Meta:[65511,65511,65512],ModeChange:[65406],NumLock:[65407],PageDown:[65366],PageUp:[65365],Pause:[65299],Play:[64790],PreviousCandidate:[65342],PrintScreen:[65377],Redo:[65382],Right:[65363],RomanCharacters:null,Scroll:[65300],Select:[65376],Separator:[65452],Shift:[65505,65505,65506],SingleCandidate:[65340],Super:[65515,65515,65516],Tab:[65289],UIKeyInputDownArrow:[65364],UIKeyInputEscape:[65307],UIKeyInputLeftArrow:[65361],UIKeyInputRightArrow:[65363],UIKeyInputUpArrow:[65362],Up:[65362],Undo:[65381],Win:[65511,65511,65512],Zenkaku:[65320],ZenkakuHankaku:[65322]},E={65027:!0,65505:!0,65506:!0,65507:!0,65508:!0,65509:!0,65511:!0,65512:!0,65513:!0,65514:!0,65515:!0,65516:!0};this.modifiers=new t.Keyboard.ModifierState,this.pressed={};var f={},u={},v={},y=null,S=null,C=function(a,c){return a?a[c]||a[0]:null},w=function(a){return a>=0&&a<=255||(a&4294901760)===16777216};function _(r,a,c){if(!r)return null;var F,m=r.indexOf("U+");if(m>=0){var A=r.substring(m+2);F=String.fromCharCode(parseInt(A,16))}else if(r.length===1&&a!==3)F=r;else return C(x[r],a);c===!0?F=F.toUpperCase():c===!1&&(F=F.toLowerCase());var D=F.charCodeAt(0);return k(D)}function b(r){return r<=31||r>=127&&r<=159}function k(r){return b(r)?65280|r:r>=0&&r<=255?r:r>=256&&r<=1114111?16777216|r:null}function L(r,a){return C(I[r],a)}var P=function(a,c){if(!c)return!1;var F=c.indexOf("U+");if(F===-1)return!0;var m=parseInt(c.substring(F+2),16);return a!==m||a>=65&&a<=90||a>=48&&a<=57};this.press=function(r){if(r!==null){if(!n.pressed[r]&&(n.pressed[r]=!0,n.onkeydown)){var a=n.onkeydown(r);return u[r]=a,globalThis.clearTimeout(y),globalThis.clearInterval(S),E[r]||(y=globalThis.setTimeout(function(){S=globalThis.setInterval(function(){n.onkeyup(r),n.onkeydown(r)},50)},500)),a}return u[r]||!1}},this.release=function(r){n.pressed[r]&&(delete n.pressed[r],delete f[r],globalThis.clearTimeout(y),globalThis.clearInterval(S),r!==null&&n.onkeyup&&n.onkeyup(r))},this.type=function(a){for(var c=0;c<a.length;c++){var F=a.codePointAt?a.codePointAt(c):a.charCodeAt(c),m=k(F);n.press(m),n.release(m)}},this.reset=function(){for(var r in n.pressed)n.release(parseInt(r));T=[]};var R=function(a,c,F){var m=F.modifiers[a],A=n.modifiers[a],D;if(c.indexOf(F.keysym)===-1){if(A&&m===!1)for(D=0;D<c.length;D++)n.release(c[D]);else if(!A&&m){for(D=0;D<c.length;D++)if(n.pressed[c[D]])return;var U=c[0];F.keysym&&(f[U]=!0),n.press(U)}}},K=function(a){R("alt",[65513,65514,65027],a),R("shift",[65505,65506],a),R("ctrl",[65507,65508],a),R("meta",[65511,65512],a),R("hyper",[65515,65516],a),n.modifiers=a.modifiers},M=function(){for(var a in n.pressed)if(!f[a])return!1;return!0};function N(){var r=H();if(!r)return!1;var a;do a=r,r=H();while(r!==null);return M()&&n.reset(),a.defaultPrevented}var z=function(a){!n.modifiers.ctrl||!n.modifiers.alt||a>=65&&a<=90||a>=97&&a<=122||(a<=255||(a&4278190080)===16777216)&&(n.release(65507),n.release(65508),n.release(65513),n.release(65514))},H=function(){var a=T[0];if(!a)return null;if(a instanceof h){var c=null,F=[];if(a.keysym===65511||a.keysym===65512){if(T.length===1)return null;if(T[1].keysym!==a.keysym){if(!T[1].modifiers.meta)return T.shift()}else if(T[1]instanceof h)return T.shift()}if(a.reliable?(c=a.keysym,F=T.splice(0,1)):T[1]instanceof d?(c=T[1].keysym,F=T.splice(0,2)):T[1]&&(c=a.keysym,F=T.splice(0,1)),F.length>0){if(K(a),c){z(c);var m=!n.press(c);v[a.keyCode]=c,a.keyupReliable||n.release(c);for(var A=0;A<F.length;A++)F[A].defaultPrevented=m}return a}}else if(a instanceof p&&!s.keyupUnreliable){var c=a.keysym;if(c)n.release(c),delete v[a.keyCode],a.defaultPrevented=!0;else return n.reset(),a;return K(a),T.shift()}else return T.shift();return null},B=function(a){return"location"in a?a.location:"keyLocation"in a?a.keyLocation:0},O=function(a){return a[i]?!1:(a[i]=!0,!0)};this.listenTo=function(a){a.addEventListener("keydown",function(m){if(n.onkeydown&&O(m)){var A=new h(m);A.keyCode!==229&&(T.push(A),N()&&m.preventDefault())}},!0),a.addEventListener("keypress",function(m){!n.onkeydown&&!n.onkeyup||O(m)&&(T.push(new d(m)),N()&&m.preventDefault())},!0),a.addEventListener("keyup",function(m){n.onkeyup&&O(m)&&(m.preventDefault(),T.push(new p(m)),N())},!0);var c=function(A){!n.onkeydown&&!n.onkeyup||O(A)&&A.data&&!A.isComposing&&(a.removeEventListener("compositionend",F,!1),n.type(A.data))},F=function(A){!n.onkeydown&&!n.onkeyup||O(A)&&A.data&&(a.removeEventListener("input",c,!1),n.type(A.data))};a.addEventListener("input",c,!1),a.addEventListener("compositionend",F,!1)},e&&n.listenTo(e)};t.Keyboard._nextID=0;t.Keyboard.ModifierState=function(){this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.hyper=!1};t.Keyboard.ModifierState.fromKeyboardEvent=function(l){var e=new t.Keyboard.ModifierState;return e.shift=l.shiftKey,e.ctrl=l.ctrlKey,e.alt=l.altKey,e.meta=l.metaKey,l.getModifierState&&(e.hyper=l.getModifierState("OS")||l.getModifierState("Super")||l.getModifierState("Hyper")||l.getModifierState("Win")),e};var t=t||{};t.Layer=function(l,e){var n=this,o=64,i=document.createElement("canvas"),s=i.getContext("2d");s.save();var g=!0,h=!0,d=0,p={1:"destination-in",2:"destination-out",4:"source-in",6:"source-atop",8:"source-out",9:"destination-atop",10:"xor",11:"destination-over",12:"copy",14:"source-over",15:"lighter"},T=function(E,f){E=E||0,f=f||0;var u=Math.ceil(E/o)*o,v=Math.ceil(f/o)*o;if(i.width!==u||i.height!==v){var y=null;if(!g&&i.width!==0&&i.height!==0){y=document.createElement("canvas"),y.width=Math.min(n.width,E),y.height=Math.min(n.height,f);var S=y.getContext("2d");S.drawImage(i,0,0,y.width,y.height,0,0,y.width,y.height)}var C=s.globalCompositeOperation;i.width=u,i.height=v,y&&s.drawImage(y,0,0,y.width,y.height,0,0,y.width,y.height),s.globalCompositeOperation=C,d=0,s.save()}else n.reset();n.width=E,n.height=f};function I(x,E,f,u){var v=f+x,y=u+E,S;v>n.width?S=v:S=n.width;var C;y>n.height?C=y:C=n.height,n.resize(S,C)}this.autosize=!1,this.width=l,this.height=e,this.getCanvas=function(){return i},this.toCanvas=function(){var E=document.createElement("canvas");E.width=n.width,E.height=n.height;var f=E.getContext("2d");return f.drawImage(n.getCanvas(),0,0),E},this.resize=function(x,E){(x!==n.width||E!==n.height)&&T(x,E)},this.drawImage=function(x,E,f){n.autosize&&I(x,E,f.width,f.height),s.drawImage(f,x,E),g=!1},this.transfer=function(x,E,f,u,v,y,S,C){var w=x.getCanvas();if(!(E>=w.width||f>=w.height)&&(E+u>w.width&&(u=w.width-E),f+v>w.height&&(v=w.height-f),!(u===0||v===0))){n.autosize&&I(y,S,u,v);for(var _=x.getCanvas().getContext("2d").getImageData(E,f,u,v),b=s.getImageData(y,S,u,v),k=0;k<u*v*4;k+=4){var L=new t.Layer.Pixel(_.data[k],_.data[k+1],_.data[k+2],_.data[k+3]),P=new t.Layer.Pixel(b.data[k],b.data[k+1],b.data[k+2],b.data[k+3]);C(L,P),b.data[k]=P.red,b.data[k+1]=P.green,b.data[k+2]=P.blue,b.data[k+3]=P.alpha}s.putImageData(b,y,S),g=!1}},this.put=function(x,E,f,u,v,y,S){var C=x.getCanvas();if(!(E>=C.width||f>=C.height)&&(E+u>C.width&&(u=C.width-E),f+v>C.height&&(v=C.height-f),!(u===0||v===0))){n.autosize&&I(y,S,u,v);var w=x.getCanvas().getContext("2d").getImageData(E,f,u,v);s.putImageData(w,y,S),g=!1}},this.copy=function(x,E,f,u,v,y,S){var C=x.getCanvas();E>=C.width||f>=C.height||(E+u>C.width&&(u=C.width-E),f+v>C.height&&(v=C.height-f),!(u===0||v===0)&&(n.autosize&&I(y,S,u,v),s.drawImage(C,E,f,u,v,y,S,u,v),g=!1))},this.moveTo=function(x,E){h&&(s.beginPath(),h=!1),n.autosize&&I(x,E,0,0),s.moveTo(x,E)},this.lineTo=function(x,E){h&&(s.beginPath(),h=!1),n.autosize&&I(x,E,0,0),s.lineTo(x,E)},this.arc=function(x,E,f,u,v,y){h&&(s.beginPath(),h=!1),n.autosize&&I(x,E,0,0),s.arc(x,E,f,u,v,y)},this.curveTo=function(x,E,f,u,v,y){h&&(s.beginPath(),h=!1),n.autosize&&I(v,y,0,0),s.bezierCurveTo(x,E,f,u,v,y)},this.close=function(){s.closePath(),h=!0},this.rect=function(x,E,f,u){h&&(s.beginPath(),h=!1),n.autosize&&I(x,E,f,u),s.rect(x,E,f,u)},this.clip=function(){s.clip(),h=!0},this.strokeColor=function(x,E,f,u,v,y,S){s.lineCap=x,s.lineJoin=E,s.lineWidth=f,s.strokeStyle="rgba("+u+","+v+","+y+","+S/255+")",s.stroke(),g=!1,h=!0},this.fillColor=function(x,E,f,u){s.fillStyle="rgba("+x+","+E+","+f+","+u/255+")",s.fill(),g=!1,h=!0},this.strokeLayer=function(x,E,f,u){s.lineCap=x,s.lineJoin=E,s.lineWidth=f,s.strokeStyle=s.createPattern(u.getCanvas(),"repeat"),s.stroke(),g=!1,h=!0},this.fillLayer=function(x){s.fillStyle=s.createPattern(x.getCanvas(),"repeat"),s.fill(),g=!1,h=!0},this.push=function(){s.save(),d++},this.pop=function(){d>0&&(s.restore(),d--)},this.reset=function(){for(;d>0;)s.restore(),d--;s.restore(),s.save(),s.beginPath(),h=!1},this.setTransform=function(x,E,f,u,v,y){s.setTransform(x,E,f,u,v,y)},this.transform=function(x,E,f,u,v,y){s.transform(x,E,f,u,v,y)},this.setChannelMask=function(x){s.globalCompositeOperation=p[x]},this.setMiterLimit=function(x){s.miterLimit=x},T(l,e),i.style.zIndex=-1};t.Layer.ROUT=2;t.Layer.ATOP=6;t.Layer.XOR=10;t.Layer.ROVER=11;t.Layer.OVER=14;t.Layer.PLUS=15;t.Layer.RIN=1;t.Layer.IN=4;t.Layer.OUT=8;t.Layer.RATOP=9;t.Layer.SRC=12;t.Layer.Pixel=function(l,e,n,o){this.red=l,this.green=e,this.blue=n,this.alpha=o};var t=t||{};t.Mouse=function(e){t.Mouse.Event.Target.call(this);var n=this;this.touchMouseThreshold=3,this.scrollThreshold=53,this.PIXELS_PER_LINE=18,this.PIXELS_PER_PAGE=this.PIXELS_PER_LINE*16;var o=[t.Mouse.State.Buttons.LEFT,t.Mouse.State.Buttons.MIDDLE,t.Mouse.State.Buttons.RIGHT],i=0,s=0;e.addEventListener("contextmenu",function(p){t.Event.DOMEvent.cancelEvent(p)},!1),e.addEventListener("mousemove",function(p){if(i){t.Event.DOMEvent.cancelEvent(p),i--;return}n.move(t.Position.fromClientPosition(e,p.clientX,p.clientY),p)},!1),e.addEventListener("mousedown",function(p){if(i){t.Event.DOMEvent.cancelEvent(p);return}var T=o[p.button];T&&n.press(T,p)},!1),e.addEventListener("mouseup",function(p){if(i){t.Event.DOMEvent.cancelEvent(p);return}var T=o[p.button];T&&n.release(T,p)},!1),e.addEventListener("mouseout",function(p){p||(p=globalThis.event);for(var T=p.relatedTarget||p.toElement;T;){if(T===e)return;T=T.parentNode}n.reset(p),n.out(p)},!1),e.addEventListener("selectstart",function(p){t.Event.DOMEvent.cancelEvent(p)},!1);function g(){i=n.touchMouseThreshold}e.addEventListener("touchmove",g,!1),e.addEventListener("touchstart",g,!1),e.addEventListener("touchend",g,!1);function h(p){var T=p.deltaY||-p.wheelDeltaY||-p.wheelDelta;if(T?p.deltaMode===1?T=p.deltaY*n.PIXELS_PER_LINE:p.deltaMode===2&&(T=p.deltaY*n.PIXELS_PER_PAGE):T=p.detail*n.PIXELS_PER_LINE,s+=T,s<=-n.scrollThreshold){do n.click(t.Mouse.State.Buttons.UP),s+=n.scrollThreshold;while(s<=-n.scrollThreshold);s=0}if(s>=n.scrollThreshold){do n.click(t.Mouse.State.Buttons.DOWN),s-=n.scrollThreshold;while(s>=n.scrollThreshold);s=0}t.Event.DOMEvent.cancelEvent(p)}e.addEventListener("DOMMouseScroll",h,!1),e.addEventListener("mousewheel",h,!1),e.addEventListener("wheel",h,!1);var d=function(){var p=document.createElement("div");if(!("cursor"in p.style))return!1;try{p.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==) 0 0, auto"}catch{return!1}return/\burl\([^()]*\)\s+0\s+0\b/.test(p.style.cursor||"")}();this.setCursor=function(p,T,I){if(d){var x=p.toDataURL("image/png");return e.style.cursor="url("+x+") "+T+" "+I+", auto",!0}return!1}};t.Mouse.State=function(e){var n=function(i,s,g,h,d,p,T){return{x:i,y:s,left:g,middle:h,right:d,up:p,down:T}};arguments.length>1?e=n.apply(this,arguments):e=e||{},t.Position.call(this,e),this.left=e.left||!1,this.middle=e.middle||!1,this.right=e.right||!1,this.up=e.up||!1,this.down=e.down||!1};t.Mouse.State.Buttons={LEFT:"left",MIDDLE:"middle",RIGHT:"right",UP:"up",DOWN:"down"};t.Mouse.Event=function(e,n,o){t.Event.DOMEvent.call(this,e,o);var i="on"+this.type;this.state=n,this.invokeLegacyHandler=function(g){g[i]&&(this.preventDefault(),this.stopPropagation(),g[i](this.state))}};t.Mouse.Event.Target=function(){t.Event.Target.call(this),this.currentState=new t.Mouse.State,this.press=function(n,o){this.currentState[n]||(this.currentState[n]=!0,this.dispatch(new t.Mouse.Event("mousedown",this.currentState,o)))},this.release=function(n,o){this.currentState[n]&&(this.currentState[n]=!1,this.dispatch(new t.Mouse.Event("mouseup",this.currentState,o)))},this.click=function(n,o){this.press(n,o),this.release(n,o)},this.move=function(n,o){(this.currentState.x!==n.x||this.currentState.y!==n.y)&&(this.currentState.x=n.x,this.currentState.y=n.y,this.dispatch(new t.Mouse.Event("mousemove",this.currentState,o)))},this.out=function(n){this.dispatch(new t.Mouse.Event("mouseout",this.currentState,n))},this.reset=function(n){for(var o in t.Mouse.State.Buttons)this.release(t.Mouse.State.Buttons[o],n)}};t.Mouse.Touchpad=function(e){t.Mouse.Event.Target.call(this);var n=this;this.scrollThreshold=20*(globalThis.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=10*(globalThis.devicePixelRatio||1),this.currentState=new t.Mouse.State;var o=0,i=0,s=0,g=0,h=0,d={1:"left",2:"right",3:"middle"},p=!1,T=null;e.addEventListener("touchend",function(I){if(I.preventDefault(),p&&I.touches.length===0){var x=new Date().getTime(),E=d[o];n.currentState[E]&&(n.release(E,I),T&&(globalThis.clearTimeout(T),T=null)),x-g<=n.clickTimingThreshold&&h<n.clickMoveThreshold&&(n.press(E,I),T=globalThis.setTimeout(function(){n.release(E,I),p=!1},n.clickTimingThreshold)),T||(p=!1)}},!1),e.addEventListener("touchstart",function(I){if(I.preventDefault(),o=Math.min(I.touches.length,3),T&&(globalThis.clearTimeout(T),T=null),!p){p=!0;var x=I.touches[0];i=x.clientX,s=x.clientY,g=new Date().getTime(),h=0}},!1),e.addEventListener("touchmove",function(I){I.preventDefault();var x=I.touches[0],E=x.clientX-i,f=x.clientY-s;if(h+=Math.abs(E)+Math.abs(f),o===1){var u=h/(new Date().getTime()-g),v=1+u,y=new t.Position(n.currentState);y.x+=E*v,y.y+=f*v,y.x=Math.min(Math.max(0,y.x),e.offsetWidth-1),y.y=Math.min(Math.max(0,y.y),e.offsetHeight-1),n.move(y,I),i=x.clientX,s=x.clientY}else if(o===2&&Math.abs(f)>=n.scrollThreshold){var S;f>0?S="down":S="up",n.click(S,I),i=x.clientX,s=x.clientY}},!1)};t.Mouse.Touchscreen=function(e){t.Mouse.Event.Target.call(this);var n=this,o=!1,i=null,s=null,g=null,h=null;this.scrollThreshold=20*(globalThis.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=16*(globalThis.devicePixelRatio||1),this.longPressThreshold=500;function d(I){var x=I.touches[0]||I.changedTouches[0],E=x.clientX-i,f=x.clientY-s;return Math.sqrt(E*E+f*f)>=n.clickMoveThreshold}function p(I){var x=I.touches[0];o=!0,i=x.clientX,s=x.clientY}function T(){globalThis.clearTimeout(g),globalThis.clearTimeout(h),o=!1}e.addEventListener("touchend",function(I){if(o){if(I.touches.length!==0||I.changedTouches.length!==1){T();return}if(globalThis.clearTimeout(h),n.release(t.Mouse.State.Buttons.LEFT,I),!d(I)&&(I.preventDefault(),!n.currentState.left)){var x=I.changedTouches[0];n.move(t.Position.fromClientPosition(e,x.clientX,x.clientY)),n.press(t.Mouse.State.Buttons.LEFT,I),g=globalThis.setTimeout(function(){n.release(t.Mouse.State.Buttons.LEFT,I),T()},n.clickTimingThreshold)}}},!1),e.addEventListener("touchstart",function(I){if(I.touches.length!==1){T();return}I.preventDefault(),p(I),globalThis.clearTimeout(g),h=globalThis.setTimeout(function(){var x=I.touches[0];n.move(t.Position.fromClientPosition(e,x.clientX,x.clientY)),n.click(t.Mouse.State.Buttons.RIGHT,I),T()},n.longPressThreshold)},!1),e.addEventListener("touchmove",function(I){if(o){if(d(I)&&globalThis.clearTimeout(h),I.touches.length!==1){T();return}if(n.currentState.left){I.preventDefault();var x=I.touches[0];n.move(t.Position.fromClientPosition(e,x.clientX,x.clientY),I)}}},!1)};var t=t||{},t=t||{};t.Object=function(e,n){var o=this,i={},s=function(d){var p=i[d];if(!p)return null;var T=p.shift();return p.length===0&&delete i[d],T},g=function(d,p){var T=i[d];T||(T=[],i[d]=T),T.push(p)};this.index=n,this.onbody=function(d,p,T){var I=s(T);I&&I(d,p)},this.onundefine=null,this.requestInputStream=function(d,p){p&&g(d,p),e.requestObjectInputStream(o.index,d)},this.createOutputStream=function(d,p){return e.createObjectOutputStream(o.index,d,p)}};t.Object.ROOT_STREAM="/";t.Object.STREAM_INDEX_MIMETYPE="application/vnd.glyptodon.guacamole.stream-index+json";var t=t||{};t.OnScreenKeyboard=function(l){var e=this,n={},o={},i=[],s=function(w,_){w.classList?w.classList.add(_):w.className+=" "+_},g=function(w,_){w.classList?w.classList.remove(_):w.className=w.className.replace(/([^ ]+)[ ]*/g,function(k,L){return L===_?"":k})},h=0,d=function(){h=e.touchMouseThreshold},p=function(w,_,b,k){this.width=_,this.height=b,this.scale=function(L){w.style.width=_*L+"px",w.style.height=b*L+"px",k&&(w.style.lineHeight=b*L+"px",w.style.fontSize=L+"px")}},T=function(w){for(var _=0;_<w.length;_++){var b=w[_];if(!(b in n))return!1}return!0},I=function(w){var _=e.keys[w];if(!_)return null;for(var b=_.length-1;b>=0;b--){var k=_[b];if(T(k.requires))return k}return null},x=function(w,_){if(!o[w]){s(_,"guac-keyboard-pressed");var b=I(w);if(b.modifier){var k="guac-keyboard-modifier-"+y(b.modifier),L=n[b.modifier];L===void 0?(s(f,k),n[b.modifier]=b.keysym,b.keysym&&e.onkeydown&&e.onkeydown(b.keysym)):(g(f,k),delete n[b.modifier],L&&e.onkeyup&&e.onkeyup(L))}else e.onkeydown&&e.onkeydown(b.keysym);o[w]=!0}},E=function(w,_){if(o[w]){g(_,"guac-keyboard-pressed");var b=I(w);!b.modifier&&e.onkeyup&&e.onkeyup(b.keysym),o[w]=!1}},f=document.createElement("div");f.className="guac-keyboard",f.onselectstart=f.onmousemove=f.onmouseup=f.onmousedown=function(w){return h&&h--,w.stopPropagation(),!1},this.touchMouseThreshold=3,this.onkeydown=null,this.onkeyup=null,this.layout=new t.OnScreenKeyboard.Layout(l),this.getElement=function(){return f},this.resize=function(C){for(var w=Math.floor(C*10/e.layout.width)/10,_=0;_<i.length;_++){var b=i[_];b.scale(w)}};var u=function(w,_){if(_ instanceof Array){for(var b=[],k=0;k<_.length;k++)b.push(new t.OnScreenKeyboard.Key(_[k],w));return b}return typeof _=="number"?[new t.OnScreenKeyboard.Key({name:w,keysym:_})]:typeof _=="string"?[new t.OnScreenKeyboard.Key({name:w,title:_})]:[new t.OnScreenKeyboard.Key(_,w)]},v=function(w){var _={};for(var b in l.keys)_[b]=u(b,w[b]);return _};this.keys=v(l.keys);var y=function(w){var _=w.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[^A-Za-z0-9]+/g,"-").toLowerCase();return _},S=function C(w,_,b){var k,L=document.createElement("div");if(b&&s(L,"guac-keyboard-"+y(b)),_ instanceof Array)for(s(L,"guac-keyboard-group"),k=0;k<_.length;k++)C(L,_[k]);else if(_ instanceof Object){s(L,"guac-keyboard-group");var P=Object.keys(_).sort();for(k=0;k<P.length;k++){var b=P[k];C(L,_[b],b)}}else if(typeof _=="number")s(L,"guac-keyboard-gap"),i.push(new p(L,_,_));else if(typeof _=="string"){var R=_;R.length===1&&(R="0x"+R.charCodeAt(0).toString(16)),s(L,"guac-keyboard-key-container");var K=document.createElement("div");K.className="guac-keyboard-key guac-keyboard-key-"+y(R);var M=e.keys[_];if(M)for(k=0;k<M.length;k++){var N=M[k],z=document.createElement("div");z.className="guac-keyboard-cap",z.textContent=N.title;for(var H=0;H<N.requires.length;H++){var B=N.requires[H];s(z,"guac-keyboard-requires-"+y(B)),s(K,"guac-keyboard-uses-"+y(B))}K.appendChild(z)}L.appendChild(K),i.push(new p(L,e.layout.keyWidths[_]||1,1,!0));var O=function(m){m.preventDefault(),h=e.touchMouseThreshold,x(_,K)},r=function(m){m.preventDefault(),h=e.touchMouseThreshold,E(_,K)},a=function(m){m.preventDefault(),h===0&&x(_,K)},c=function(m){m.preventDefault(),h===0&&E(_,K)};K.addEventListener("touchstart",O,!0),K.addEventListener("touchend",r,!0),K.addEventListener("mousedown",a,!0),K.addEventListener("mouseup",c,!0),K.addEventListener("mouseout",c,!0)}w.appendChild(L)};S(f,l.layout)};t.OnScreenKeyboard.Layout=function(l){this.language=l.language,this.type=l.type,this.keys=l.keys,this.layout=l.layout,this.width=l.width,this.keyWidths=l.keyWidths||{}};t.OnScreenKeyboard.Key=function(l,e){this.name=e||l.name,this.title=l.title||this.name,this.keysym=l.keysym||function(o){if(!o||o.length!==1)return null;var i=o.charCodeAt(0);return i>=0&&i<=255?i:i>=256&&i<=1114111?16777216|i:null}(this.title),this.modifier=l.modifier,this.requires=l.requires||[]};var t=t||{};t.OutputStream=function(l,e){var n=this;this.index=e,this.onack=null,this.sendBlob=function(o){l.sendBlob(n.index,o)},this.sendEnd=function(){l.endStream(n.index)}};var t=t||{};t.Parser=function(){var e=this,n="",o=[],i=-1,s=0,g=0,h=4096,d=65536;this.receive=function(T,I){for(I?n=T:(s>h&&i>=s&&(n=n.substring(s),i-=s,s=0),n.length?n+=T:n=T);i<n.length;){if(i>=s){var x=t.Parser.codePointCount(n,s,i);if(x<g){i+=g-x;continue}else if(g&&n.codePointAt(i-1)>=d){i++;continue}var E=n.substring(s,i),f=n.substring(i,i+1);if(o.push(E),f===";"){var u=o.shift();e.oninstruction!==null&&e.oninstruction(u,o),o=[],!I&&i+1===n.length&&(i=-1,n="")}else if(f!==",")throw new Error('Element terminator of instruction was not ";" nor ",".');s=i+1}var v=n.indexOf(".",s);if(v!==-1){if(g=parseInt(n.substring(i+1,v)),isNaN(g))throw new Error("Non-numeric character in element length.");s=v+1,i=s+g}else{s=n.length;break}}},this.oninstruction=null};t.Parser.codePointCount=function(e,n,o){e=e.substring(n||0,o);var i=e.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g);return e.length-(i?i.length:0)};t.Parser.toInstruction=function(e){for(var n=function(g){var h=""+g;return t.Parser.codePointCount(h)+"."+h},o=n(e[0]),i=1;i<e.length;i++)o+=","+n(e[i]);return o+";"};var t=t||{};t.Position=function(e){e=e||{},this.x=e.x||0,this.y=e.y||0,this.fromClientPosition=function(o,i,s){this.x=i-o.offsetLeft,this.y=s-o.offsetTop;for(var g=o.offsetParent;g&&g!==document.body;)this.x-=g.offsetLeft-g.scrollLeft,this.y-=g.offsetTop-g.scrollTop,g=g.offsetParent;if(g){var h=document.body.scrollLeft||document.documentElement.scrollLeft,d=document.body.scrollTop||document.documentElement.scrollTop;this.x-=g.offsetLeft-h,this.y-=g.offsetTop-d}}};t.Position.fromClientPosition=function(e,n,o){var i=new t.Position;return i.fromClientPosition(e,n,o),i};var t=t||{};t.RawAudioFormat=function(e){this.bytesPerSample=e.bytesPerSample,this.channels=e.channels,this.rate=e.rate};t.RawAudioFormat.parse=function(e){var n,o=null,i=1;if(e.substring(0,9)==="audio/L8;")e=e.substring(9),n=1;else if(e.substring(0,10)==="audio/L16;")e=e.substring(10),n=2;else return null;for(var s=e.split(","),g=0;g<s.length;g++){var h=s[g],d=h.indexOf("=");if(d===-1)return null;var p=h.substring(0,d),T=h.substring(d+1);switch(p){case"channels":i=parseInt(T);break;case"rate":o=parseInt(T);break;default:return null}}return o===null?null:new t.RawAudioFormat({bytesPerSample:n,channels:i,rate:o})};var t=t||{};t.SessionRecording=function(e){var n=this,o,i=null,s=262144,g=16384,h=5e3,d=[],p=0,T=new t.SessionRecording._PlaybackTunnel,I=new t.Client(T),x=-1,E=null,f=null,u=null,v=0,y=0,S=!1,C=null,w=function(O,r,a){if(!(S&&O===o)){var c=new t.Parser;c.oninstruction=r;var F=0,m=new FileReader,A=function(){if(!(S&&O===o)){if(m.readyState===2)try{c.receive(m.result)}catch(G){n.onerror&&n.onerror(G.message);return}if(F>=O.size)a&&a();else{var U=O.slice(F,F+s);F+=U.size,m.readAsText(U)}}};m.onload=A,A()}},_=function(O){for(var r=O.length,a=r+3;r>=10;)a++,r=Math.floor(r/10);return a};I.connect(),I.getDisplay().showCursor(!1);var b=function(O,r){y+=_(O);for(var a=0;a<r.length;a++)y+=_(r[a]);if(O==="sync"){var c=parseInt(r[0]),F=new t.SessionRecording._Frame(c,v,y);d.push(F),v=y,(d.length===1||y-d[p].start>=g&&c-d[p].timestamp>=h)&&(F.keyframe=!0,p=d.length-1),n.onprogress&&n.onprogress(n.getDuration(),y)}},k=function(){n.onload&&n.onload()};if(e instanceof Blob)o=e,w(o,b,k);else{i=e,o=new Blob;var L=!1,P="";i.oninstruction=function(O,r){P+=O.length+"."+O,r.forEach(function(c){P+=","+c.length+"."+c}),P+=";",P.length>=s&&(o=new Blob([o,P]),P=""),b(O,r)},i.onerror=function(O){L=!0,n.onerror&&n.onerror(O.message)},i.onstatechange=function(O){O===t.Tunnel.State.CLOSED&&(P.length&&(o=new Blob([o,P]),P=""),L||k())}}var R=function(O){return d.length===0?0:O-d[0].timestamp},K=function B(O,r,a){if(O===r)return O;var c=Math.floor((O+r)/2),F=R(d[c].timestamp);return a<F&&c>O?B(O,c-1,a):a>F&&c<r?B(c+1,r,a):c},M=function(O,r){var a=d[O];w(o.slice(a.start,a.end),function(F,m){T.receiveInstruction(F,m)},function(){a.keyframe&&!a.clientState&&I.exportState(function(m){a.clientState=new Blob([JSON.stringify(m)])}),x=O,r&&r()})},N=function(O,r,a){z();for(var c=u={aborted:!1},F=O,m=function U(){n.onseek&&x>F&&n.onseek(R(d[x].timestamp),x-F,O-F),!c.aborted&&(x<O?M(x+1,U):r())},A=function(){var G=a?Math.max(a-new Date().getTime(),0):0;G?globalThis.setTimeout(m,G):m()};F>=0;F--){var D=d[F];if(F===x)break;if(D.clientState){D.clientState.text().then(function(G){I.importState(JSON.parse(G)),x=F,A()});return}}A()},z=function(){u&&(u.aborted=!0,u=null)},H=function B(){if(x+1<d.length){var O=d[x+1],r=O.timestamp-E+f;N(x+1,function(){B()},r)}else n.pause()};this.onload=null,this.onerror=null,this.onabort=null,this.onprogress=null,this.onplay=null,this.onpause=null,this.onseek=null,this.connect=function(O){i&&i.connect(O)},this.disconnect=function(){i&&i.disconnect()},this.abort=function(){S||(S=!0,n.onabort&&n.onabort(),i&&i.disconnect())},this.getDisplay=function(){return I.getDisplay()},this.isPlaying=function(){return!!E},this.getPosition=function(){return x===-1?0:R(d[x].timestamp)},this.getDuration=function(){return d.length===0?0:R(d[d.length-1].timestamp)},this.play=function(){if(!n.isPlaying()&&x+1<d.length){n.onplay&&n.onplay();var O=d[x+1];E=O.timestamp,f=new Date().getTime(),H()}},this.seek=function(O,r){if(d.length!==0){n.cancel();var a=n.isPlaying();n.pause(),C=function(){C=null,a&&(n.play(),a=null),r&&r()},N(K(0,d.length-1,O),C)}},this.cancel=function(){C&&(z(),C())},this.pause=function(){z(),n.isPlaying()&&(n.onpause&&n.onpause(),E=null,f=null)}};t.SessionRecording._Frame=function(e,n,o){this.keyframe=!1,this.timestamp=e,this.start=n,this.end=o,this.clientState=null};t.SessionRecording._PlaybackTunnel=function(){var e=this;this.connect=function(o){},this.sendMessage=function(o){},this.disconnect=function(){},this.receiveInstruction=function(o,i){e.oninstruction&&e.oninstruction(o,i)}};var t=t||{};t.Status=function(l,e){var n=this;this.code=l,this.message=e,this.isError=function(){return n.code<0||n.code>255}};t.Status.Code={SUCCESS:0,UNSUPPORTED:256,SERVER_ERROR:512,SERVER_BUSY:513,UPSTREAM_TIMEOUT:514,UPSTREAM_ERROR:515,RESOURCE_NOT_FOUND:516,RESOURCE_CONFLICT:517,RESOURCE_CLOSED:518,UPSTREAM_NOT_FOUND:519,UPSTREAM_UNAVAILABLE:520,SESSION_CONFLICT:521,SESSION_TIMEOUT:522,SESSION_CLOSED:523,CLIENT_BAD_REQUEST:768,CLIENT_UNAUTHORIZED:769,CLIENT_FORBIDDEN:771,CLIENT_TIMEOUT:776,CLIENT_OVERRUN:781,CLIENT_BAD_TYPE:783,CLIENT_TOO_MANY:797};t.Status.Code.fromHTTPCode=function(e){switch(e){case 400:return t.Status.Code.CLIENT_BAD_REQUEST;case 403:return t.Status.Code.CLIENT_FORBIDDEN;case 404:return t.Status.Code.RESOURCE_NOT_FOUND;case 429:return t.Status.Code.CLIENT_TOO_MANY;case 503:return t.Status.Code.SERVER_BUSY}return t.Status.Code.SERVER_ERROR};t.Status.Code.fromWebSocketCode=function(e){switch(e){case 1e3:return t.Status.Code.SUCCESS;case 1006:case 1015:return t.Status.Code.UPSTREAM_NOT_FOUND;case 1001:case 1012:case 1013:case 1014:return t.Status.Code.UPSTREAM_UNAVAILABLE}return t.Status.Code.SERVER_ERROR};var t=t||{};t.StringReader=function(l){var e=this,n=new t.UTF8Parser,o=new t.ArrayBufferReader(l);o.ondata=function(i){var s=n.decode(i);e.ontext&&e.ontext(s)},o.onend=function(){e.onend&&e.onend()},this.ontext=null,this.onend=null};var t=t||{};t.StringWriter=function(l){var e=this,n=new t.ArrayBufferWriter(l),o=new Uint8Array(8192),i=0;n.onack=function(d){e.onack&&e.onack(d)};function s(d){if(i+d>=o.length){var p=new Uint8Array((i+d)*2);p.set(o),o=p}i+=d}function g(d){var p,T;if(d<=127)p=0,T=1;else if(d<=2047)p=192,T=2;else if(d<=65535)p=224,T=3;else if(d<=2097151)p=240,T=4;else{g(65533);return}s(T);for(var I=i-1,x=1;x<T;x++)o[I--]=128|d&63,d>>=6;o[I]=p|d}function h(d){for(var p=0;p<d.length;p++){var T=d.charCodeAt(p);g(T)}if(i>0){var I=o.subarray(0,i);return i=0,I}}this.sendText=function(d){d.length&&n.sendData(h(d))},this.sendEnd=function(){n.sendEnd()},this.onack=null};var t=t||{};t.Touch=function(e){t.Event.Target.call(this);var n=this,o=Math.floor(16*globalThis.devicePixelRatio);this.touches={},this.activeTouches=0,e.addEventListener("touchstart",function(s){for(var g=0;g<s.changedTouches.length;g++){var h=s.changedTouches[g],d=h.identifier;if(!n.touches[d]){var p=n.touches[d]=new t.Touch.State({id:d,radiusX:h.radiusX||o,radiusY:h.radiusY||o,angle:h.angle||0,force:h.force||1});n.activeTouches++,p.fromClientPosition(e,h.clientX,h.clientY),n.dispatch(new t.Touch.Event("touchmove",s,p))}}},!1),e.addEventListener("touchmove",function(s){for(var g=0;g<s.changedTouches.length;g++){var h=s.changedTouches[g],d=h.identifier,p=n.touches[d];p&&(h.force&&(p.force=h.force),p.angle=h.angle||0,p.radiusX=h.radiusX||o,p.radiusY=h.radiusY||o,p.fromClientPosition(e,h.clientX,h.clientY),n.dispatch(new t.Touch.Event("touchmove",s,p)))}},!1),e.addEventListener("touchend",function(s){for(var g=0;g<s.changedTouches.length;g++){var h=s.changedTouches[g],d=h.identifier,p=n.touches[d];p&&(delete n.touches[d],n.activeTouches--,p.force=0,p.fromClientPosition(e,h.clientX,h.clientY),n.dispatch(new t.Touch.Event("touchend",s,p)))}},!1)};t.Touch.State=function(e){e=e||{},t.Position.call(this,e),this.id=e.id||0,this.radiusX=e.radiusX||0,this.radiusY=e.radiusY||0,this.angle=e.angle||0,this.force=e.force||1};t.Touch.Event=function(e,n,o){t.Event.DOMEvent.call(this,e,[n]),this.state=o};var t=t||{};t.Tunnel=function(){this.connect=function(l){},this.disconnect=function(){},this.sendMessage=function(l){},this.setState=function(l){l!==this.state&&(this.state=l,this.onstatechange&&this.onstatechange(l))},this.setUUID=function(e){this.uuid=e,this.onuuid&&this.onuuid(e)},this.isConnected=function(){return this.state===t.Tunnel.State.OPEN||this.state===t.Tunnel.State.UNSTABLE},this.state=t.Tunnel.State.CLOSED,this.receiveTimeout=15e3,this.unstableThreshold=1500,this.uuid=null,this.onuuid=null,this.onerror=null,this.onstatechange=null,this.oninstruction=null};t.Tunnel.INTERNAL_DATA_OPCODE="";t.Tunnel.State={CONNECTING:0,OPEN:1,CLOSED:2,UNSTABLE:3};t.HTTPTunnel=function(l,e,n){var o=this,i=l+"?connect",s=l+"?read:",g=l+"?write:",h=1,d=0,p=h,T=!1,I="",x=!!e,E=null,f=null,u=null,v=500,y=n||{},S="Guacamole-Tunnel-Token",C=null;function w(M,N){for(var z in N)M.setRequestHeader(z,N[z])}var _=function(){globalThis.clearTimeout(E),globalThis.clearTimeout(f),o.state===t.Tunnel.State.UNSTABLE&&o.setState(t.Tunnel.State.OPEN),E=globalThis.setTimeout(function(){b(new t.Status(t.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},o.receiveTimeout),f=globalThis.setTimeout(function(){o.setState(t.Tunnel.State.UNSTABLE)},o.unstableThreshold)};function b(M){globalThis.clearTimeout(E),globalThis.clearTimeout(f),globalThis.clearInterval(u),o.state!==t.Tunnel.State.CLOSED&&(M.code!==t.Status.Code.SUCCESS&&o.onerror&&(o.state===t.Tunnel.State.CONNECTING||M.code!==t.Status.Code.RESOURCE_NOT_FOUND)&&o.onerror(M),T=!1,o.setState(t.Tunnel.State.CLOSED))}this.sendMessage=function(){o.isConnected()&&arguments.length&&(I+=t.Parser.toInstruction(arguments),T||k())};function k(){if(o.isConnected())if(I.length>0){T=!0;var M=new XMLHttpRequest;M.open("POST",g+o.uuid),M.withCredentials=x,w(M,y),M.setRequestHeader("Content-type","application/octet-stream"),M.setRequestHeader(S,C),M.onreadystatechange=function(){M.readyState===4&&(_(),M.status!==200?L(M):k())},M.send(I),I=""}else T=!1}function L(M){var N=parseInt(M.getResponseHeader("Guacamole-Status-Code"));if(N){var z=M.getResponseHeader("Guacamole-Error-Message");b(new t.Status(N,z))}else M.status?b(new t.Status(t.Status.Code.fromHTTPCode(M.status),M.statusText)):b(new t.Status(t.Status.Code.UPSTREAM_NOT_FOUND))}function P(M){var N=null,z=null,H=0,B=new t.Parser;B.oninstruction=function r(a,c){a===t.Tunnel.INTERNAL_DATA_OPCODE&&c.length===0?(B=new t.Parser,B.oninstruction=r,N&&clearInterval(N),M.onreadystatechange=null,M.abort(),z&&P(z)):a!==t.Tunnel.INTERNAL_DATA_OPCODE&&o.oninstruction&&o.oninstruction(a,c)};function O(){if(!o.isConnected()){N!==null&&clearInterval(N);return}if(!(M.readyState<2)){var r;try{r=M.status}catch{r=200}if(!z&&r===200&&(z=K()),M.readyState===3||M.readyState===4){if(_(),p===h&&(M.readyState===3&&!N?N=setInterval(O,30):M.readyState===4&&N&&clearInterval(N)),M.status===0){o.disconnect();return}else if(M.status!==200){L(M);return}var a;try{a=M.responseText}catch{return}try{B.receive(a,!0)}catch(c){b(new t.Status(t.Status.Code.SERVER_ERROR,c.message));return}}}}p===h?M.onreadystatechange=function(){M.readyState===3&&(H++,H>=2&&(p=d,M.onreadystatechange=O)),O()}:M.onreadystatechange=O,O()}var R=0;function K(){var M=new XMLHttpRequest;return M.open("GET",s+o.uuid+":"+R++),M.setRequestHeader(S,C),M.withCredentials=x,w(M,y),M.send(null),M}this.connect=function(M){_(),o.setState(t.Tunnel.State.CONNECTING);var N=new XMLHttpRequest;N.onreadystatechange=function(){if(N.readyState===4){if(N.status!==200){L(N);return}if(_(),o.setUUID(N.responseText),C=N.getResponseHeader(S),!C){b(new t.Status(t.Status.Code.UPSTREAM_NOT_FOUND));return}o.setState(t.Tunnel.State.OPEN),u=setInterval(function(){o.sendMessage("nop")},v),P(K())}},N.open("POST",i,!0),N.withCredentials=x,w(N,y),N.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),N.send(M)},this.disconnect=function(){b(new t.Status(t.Status.Code.SUCCESS,"Manually closed."))}};t.HTTPTunnel.prototype=new t.Tunnel;t.WebSocketTunnel=function(l){var e=this,n=null,o=null,i=null,s=null,g=null,h={"http:":"ws:","https:":"wss:"},d=500,p=0;if(l.substring(0,3)!=="ws:"&&l.substring(0,4)!=="wss:"){var T=h[globalThis.location.protocol];if(l.substring(0,1)==="/")l=T+"//"+globalThis.location.host+l;else{var I=globalThis.location.pathname.lastIndexOf("/"),x=globalThis.location.pathname.substring(0,I+1);l=T+"//"+globalThis.location.host+x+l}}var E=function(){var y=new Date().getTime();e.sendMessage(t.Tunnel.INTERNAL_DATA_OPCODE,"ping",y),p=y},f=function(){globalThis.clearTimeout(i),globalThis.clearTimeout(s),globalThis.clearTimeout(g),e.state===t.Tunnel.State.UNSTABLE&&e.setState(t.Tunnel.State.OPEN),i=globalThis.setTimeout(function(){u(new t.Status(t.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},e.receiveTimeout),s=globalThis.setTimeout(function(){e.setState(t.Tunnel.State.UNSTABLE)},e.unstableThreshold);var y=new Date().getTime(),S=Math.max(p+d-y,0);S>0?g=globalThis.setTimeout(E,S):E()};function u(v){globalThis.clearTimeout(i),globalThis.clearTimeout(s),globalThis.clearTimeout(g),e.state!==t.Tunnel.State.CLOSED&&(v.code!==t.Status.Code.SUCCESS&&e.onerror&&e.onerror(v),e.setState(t.Tunnel.State.CLOSED),o.close())}this.sendMessage=function(v){e.isConnected()&&arguments.length&&o.send(t.Parser.toInstruction(arguments))},this.connect=function(v){f(),e.setState(t.Tunnel.State.CONNECTING),n=new t.Parser,n.oninstruction=function(S,C){e.uuid===null&&(S===t.Tunnel.INTERNAL_DATA_OPCODE&&C.length===1&&e.setUUID(C[0]),e.setState(t.Tunnel.State.OPEN)),S!==t.Tunnel.INTERNAL_DATA_OPCODE&&e.oninstruction&&e.oninstruction(S,C)},o=new WebSocket(l+"?"+v,"guacamole"),o.onopen=function(y){f()},o.onclose=function(y){y.reason?u(new t.Status(parseInt(y.reason),y.reason)):y.code?u(new t.Status(t.Status.Code.fromWebSocketCode(y.code))):u(new t.Status(t.Status.Code.UPSTREAM_NOT_FOUND))},o.onmessage=function(y){f();try{n.receive(y.data)}catch(S){u(new t.Status(t.Status.Code.SERVER_ERROR,S.message))}}},this.disconnect=function(){u(new t.Status(t.Status.Code.SUCCESS,"Manually closed."))}};t.WebSocketTunnel.prototype=new t.Tunnel;t.ChainedTunnel=function(l){for(var e=this,n,o=[],i=null,s=0;s<arguments.length;s++)o.push(arguments[s]);function g(h){e.disconnect=h.disconnect,e.sendMessage=h.sendMessage;var d=function(I){if(I&&I.code===t.Status.Code.UPSTREAM_TIMEOUT)return o=[],null;var x=o.shift();return x&&(h.onerror=null,h.oninstruction=null,h.onstatechange=null,g(x)),x};function p(){h.onstatechange=e.onstatechange,h.oninstruction=e.oninstruction,h.onerror=e.onerror,h.uuid&&e.setUUID(h.uuid),h.onuuid=function(I){e.setUUID(I)},i=h}h.onstatechange=function(T){switch(T){case t.Tunnel.State.OPEN:p(),e.onstatechange&&e.onstatechange(T);break;case t.Tunnel.State.CLOSED:!d()&&e.onstatechange&&e.onstatechange(T);break}},h.oninstruction=function(T,I){p(),e.oninstruction&&e.oninstruction(T,I)},h.onerror=function(T){!d(T)&&e.onerror&&e.onerror(T)},h.connect(n)}this.connect=function(h){n=h;var d=i||o.shift();d?g(d):e.onerror&&e.onerror(t.Status.Code.SERVER_ERROR,"No tunnels to try.")}};t.ChainedTunnel.prototype=new t.Tunnel;t.StaticHTTPTunnel=function(e,n,o){var i=this,s=null,g=o||{};this.size=null,this.sendMessage=function(d){},this.connect=function(d){i.disconnect(),i.setState(t.Tunnel.State.CONNECTING);var p=new t.Parser,T=new t.UTF8Parser;p.oninstruction=function(x,E){i.oninstruction&&i.oninstruction(x,E)},s=new AbortController,fetch(e,{headers:g,credentials:n?"include":"same-origin",signal:s.signal}).then(function(x){if(!x.ok){i.onerror&&i.onerror(new t.Status(t.Status.Code.fromHTTPCode(x.status),x.statusText)),i.disconnect();return}i.size=x.headers.get("Content-Length"),i.setState(t.Tunnel.State.OPEN);var E=x.body.getReader(),f=function u(v){if(v.done){i.disconnect();return}p.receive(T.decode(v.value)),E.read().then(u)};E.read().then(f)})},this.disconnect=function(){s&&(s.abort(),s=null),i.setState(t.Tunnel.State.CLOSED)}};t.StaticHTTPTunnel.prototype=new t.Tunnel;var t=t||{};t.UTF8Parser=function(){var e=0,n=0;this.decode=function(i){for(var s="",g=new Uint8Array(i),h=0;h<g.length;h++){var d=g[h];e===0?(d|127)===127?s+=String.fromCharCode(d):(d|31)===223?(n=d&31,e=1):(d|15)===239?(n=d&15,e=2):(d|7)===247?(n=d&7,e=3):s+="\uFFFD":(d|63)===191?(n=n<<6|d&63,e--,e===0&&(s+=String.fromCharCode(n))):(e=0,s+="\uFFFD")}return s}};var t=t||{};t.API_VERSION="1.5.4";var t=t||{};t.VideoPlayer=function(){this.sync=function(){}};t.VideoPlayer.isSupportedType=function(e){return!1};t.VideoPlayer.getSupportedTypes=function(){return[]};t.VideoPlayer.getInstance=function(e,n,o){return null};
export const ArrayBufferReader  = Guacamole.ArrayBufferReader ;
export const ArrayBufferWriter  = Guacamole.ArrayBufferWriter ;
export const AudioPlayer  = Guacamole.AudioPlayer ;
export const RawAudioPlayer  = Guacamole.RawAudioPlayer ;
export const AudioRecorder  = Guacamole.AudioRecorder ;
export const RawAudioRecorder  = Guacamole.RawAudioRecorder ;
export const BlobReader  = Guacamole.BlobReader ;
export const BlobWriter  = Guacamole.BlobWriter ;
export const Client  = Guacamole.Client ;
export const DataURIReader  = Guacamole.DataURIReader ;
export const Display  = Guacamole.Display ;
export const Event  = Guacamole.Event ;
export const InputSink  = Guacamole.InputSink ;
export const InputStream  = Guacamole.InputStream ;
export const IntegerPool  = Guacamole.IntegerPool ;
export const JSONReader  = Guacamole.JSONReader ;
export const Keyboard  = Guacamole.Keyboard ;
export const Layer  = Guacamole.Layer ;
export const Mouse  = Guacamole.Mouse ;
export const Object  = Guacamole.Object ;
export const OnScreenKeyboard  = Guacamole.OnScreenKeyboard ;
export const OutputStream  = Guacamole.OutputStream ;
export const Parser  = Guacamole.Parser ;
export const Position  = Guacamole.Position ;
export const RawAudioFormat  = Guacamole.RawAudioFormat ;
export const SessionRecording  = Guacamole.SessionRecording ;
export const Status  = Guacamole.Status ;
export const StringReader  = Guacamole.StringReader ;
export const StringWriter  = Guacamole.StringWriter ;
export const Touch  = Guacamole.Touch ;
export const Tunnel  = Guacamole.Tunnel ;
export const HTTPTunnel  = Guacamole.HTTPTunnel ;
export const WebSocketTunnel  = Guacamole.WebSocketTunnel ;
export const ChainedTunnel  = Guacamole.ChainedTunnel ;
export const StaticHTTPTunnel  = Guacamole.StaticHTTPTunnel ;
export const UTF8Parser  = Guacamole.UTF8Parser ;
export const VideoPlayer  = Guacamole.VideoPlayer ;
export default Guacamole;
